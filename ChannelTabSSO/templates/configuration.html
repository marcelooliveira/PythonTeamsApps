{% extends "base.html" %}
{% block title %}Channel Tab SSO{% endblock %}
{% block content %}
  <h1>[Python Channel Tab SSO Authentication]</h1>
  <div id="divError" style="display: none"></div>
  <button onclick="requestConsent()" id="consent" style="display:none;">Authenticate</button>
  <div id="divGraphProfile" style="display: none"></div>
{% endblock %}
{% block scripts %}
<script type="text/javascript">
  microsoftTeams.initialize();

  microsoftTeams.settings.registerOnSaveHandler((saveEvent) => {
      microsoftTeams.settings.setSettings({
          websiteUrl: window.location.origin ,
          contentUrl: window.location.origin + "/api/channel-tab-sso-index",
          entityId: "Configure",
          suggestedDisplayName: "Configure"
      });
      saveEvent.notifySuccess();
  });

  microsoftTeams.settings.setValidityState(true);
</script>

{% endblock %}
